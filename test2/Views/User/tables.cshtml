@model test2.Models.Account

@{
    ViewBag.Title = "tables";
    Layout = "~/Views/shared/_LayoutPage3.cshtml";


}
<style>
    /* CSS pour le sélecteur de taille de page */
    #pageSizeSelect {
        width: 50px; /* Largeur du sélecteur */
        padding: 5px; /* Espacement interne */
        font-size: 16px; /* Taille de la police */
        border-radius: 5px; /* Coins arrondis */
        border: 1px solid #ccc; /* Bordure */
        background-color: #fff; /* Couleur de fond */
        appearance: none; /* Suppression de l'apparence native */
        -webkit-appearance: none; /* Pour certains navigateurs WebKit */
        -moz-appearance: none; /* Pour certains navigateurs Firefox */
        text-align: center;
    }

        /* Style lorsque le sélecteur est survolé */
        #pageSizeSelect:hover {
            border-color: rgba(0, 123, 255, 0.5);
            /* Changement de couleur de la bordure */
        }

        /* Style lorsque le sélecteur est actif ou focus */
        #pageSizeSelect:focus {
            outline: none; /* Suppression de l'outline */
            border-color: #007bff; /* Changement de couleur de la bordure */
            box-shadow: 0 0 5px rgba(0, 123, 255, 0.5); /* Ombre portée */
        }

    .required::before {
        content: '*';
        color: red;
        margin-right: 5px;
    }

    /* Style pour le popup */
    .modal {
        display: none; /* Par défaut, le popup est caché */
        position: fixed;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        overflow: auto;
        background-color: rgba(0, 0, 0, 0.4); /* Couleur de fond semi-transparente */
    }

    /* Style pour la boîte de dialogue du popup */
    .modal-dialog {
        margin: 30px auto; /* Centrez la boîte de dialogue verticalement et horizontalement */
        max-width: 500px; /* Largeur maximale de la boîte de dialogue */
    }

    /* Style pour le contenu du popup */
    .modal-content {
        position: relative;
        background-color: #fefefe;
        margin: auto;
        padding: 20px;
        border: 1px solid #888;
        border-radius: 5px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); /* Ombre légère */
    }

    /* Style pour l'en-tête du popup */
    .modal-header {
        padding-bottom: 10px;
        border-bottom: 1px solid #e5e5e5;
    }

    /* Style pour le titre du popup */
    #ModalTitle {
        margin: 0 auto;
        font-size: 20px;
        color: #333;
        font-weight: bold;
    }

    /* Style pour le bouton de fermeture du popup */
    .close {
        position: absolute;
        right: 20px;
        top: 10px;
        font-size: 30px;
        color: #333;
    }

    /* Style pour le corps du popup */
    .modal-body {
        padding-top: 20px;
    }

    /* Style pour le pied de page du popup */
    .modal-footer {
        padding-top: 20px;
        border-top: 1px solid #e5e5e5;
    }

    /* Style pour le bouton "Close" du pied de page */
    .btn-close {
        background-color: #ccc;
        color: #333;
        border: none;
        padding: 8px 16px;
        border-radius: 4px;
        cursor: pointer;
    }

    /* Style pour le bouton "Save" du pied de page */
    .btn-save {
        background-color: #007bff;
        color: #fff;
        border: none;
        padding: 8px 16px;
        border-radius: 4px;
        cursor: pointer;
    }

    /* Style pour les champs de formulaire */
    .form-group {
        margin-bottom: 20px;
    }

    /* Style pour les labels */
    label {
        font-weight: bold;
    }

    /* Style pour les champs de texte */
    .form-control {
        width: 100%;
        padding: 8px;
        border: 1px solid #ccc;
        border-radius: 4px;
    }
</style>

<head>
    <link href="~/vendor/fontawesome-free/css/all.min.css" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i"
          rel="stylesheet">

    <!-- Custom styles for this template-->
    <link href="~/CSS/sb-admin-2.min.css" rel="stylesheet" />

    <!-- Custom fonts for this template -->
    <link href="~/vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i"
          rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="~/CSS/sb-admin-2.min.css" rel="stylesheet">

    <!-- Custom styles for this page -->
    <link href="~/vendor/datatables/dataTables.bootstrap4.min.css" rel="stylesheet">

</head>

<body id="page-top">

    <!-- Page Wrapper -->
    <div id="wrapper">

        <!-- Sidebar -->
        <ul class="navbar-nav bg-gradient-primary sidebar sidebar-dark accordion" id="accordionSidebar">

            <!-- Sidebar - Brand -->
            <a class="sidebar-brand d-flex align-items-center justify-content-center" href="/User/HomePage">
                <div class="sidebar-brand-icon rotate-n-15">
                    <i class="bi bi-person-circle"></i>
                </div>
                <div class="sidebar-brand-text mx-3"> Administrateur Système <sup>AS</sup></div>

            </a>

            <!-- Divider -->
            <hr class="sidebar-divider my-0">

            <!-- Nav Item - Dashboard -->
            <li class="nav-item">
                <a class="nav-link" href="/User/HomePage">
                    <i class="fas fa-fw fa-tachometer-alt"></i>

                    <span>

                        Tableau de bord
                    </span>
                </a>
            </li>

            <!-- Divider -->
            <hr class="sidebar-divider">

            <!-- Heading -->
            <div class="sidebar-heading">
                Interface
            </div>





            <!-- Nav Item - Tables -->
            <li class="nav-item active">
                <a class="nav-link" href="#">
                    <i class="fas fa-fw fa-users"></i>
                    <span>Gestion Utilisateurs</span>
                </a>
            </li>

            <!-- Divider -->
            <hr class="sidebar-divider d-none d-md-block">

            <!-- Sidebar Toggler (Sidebar) -->
            <div class="text-center d-none d-md-inline">
                <button class="rounded-circle border-0" id="sidebarToggle"></button>
            </div>

        </ul>
        <!-- End of Sidebar -->
        <!-- Content Wrapper -->

        <div id="content-wrapper" class="d-flex flex-column">

            <!-- Main Content -->
            <div id="content">

                <!-- Topbar -->
                <nav class="navbar navbar-expand navbar-light bg-white topbar mb-4 static-top shadow">



                    <div>
                        <a href="/User/HomePage"><img src="~/assets/img/Tunisair_(logo).svg" alt="" class="img-fluid" style=" max-height: 100px;width:75%;"></a>
                    </div>
                    <!-- Topbar Search -->
                    <form class="d-none d-sm-inline-block form-inline mr-auto ml-md-3 my-2 my-md-0 mw-100 navbar-search">
                        <div class="input-group">
                            <input type="text" class="form-control bg-light border-0 small" placeholder="Rechercher ..."
                                   aria-label="Search" aria-describedby="basic-addon2">
                            <div class="input-group-append">
                                <button class="btn btn-primary" type="button">
                                    <i class="fas fa-search fa-sm"></i>
                                </button>
                            </div>
                        </div>
                    </form>

                    <!-- Topbar Navbar -->
                    <ul class="navbar-nav ml-auto">

                        <!-- Nav Item - Search Dropdown (Visible Only XS) -->
                        <li class="nav-item dropdown no-arrow d-sm-none">
                            <a class="nav-link dropdown-toggle" href="#" id="searchDropdown" role="button"
                               data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <i class="fas fa-search fa-fw"></i>
                            </a>
                            <!-- Dropdown - Messages -->
                            <div class="dropdown-menu dropdown-menu-right p-3 shadow animated--grow-in"
                                 aria-labelledby="searchDropdown">
                                <form class="form-inline mr-auto w-100 navbar-search">
                                    <div class="input-group">
                                        <input type="text" class="form-control bg-light border-0 small"
                                               placeholder="Search for..." aria-label="Search"
                                               aria-describedby="basic-addon2">
                                        <div class="input-group-append">
                                            <button class="btn btn-primary" type="button">
                                                <i class="fas fa-search fa-sm"></i>
                                            </button>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </li>



                        <!-- Nav Item - Messages -->
                        <li class="nav-item dropdown no-arrow mx-1">
                            <a class="nav-link dropdown-toggle" href="#" id="messagesDropdown" role="button"
                               data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <i class="fas fa-envelope fa-fw"></i>
                                <!-- Counter - Messages -->
                                <span class="badge badge-danger badge-counter">7</span>
                            </a>
                            <!-- Dropdown - Messages -->
                            <div class="dropdown-list dropdown-menu dropdown-menu-right shadow animated--grow-in"
                                 aria-labelledby="messagesDropdown">
                                <h6 class="dropdown-header">
                                    Message Center
                                </h6>
                                <a class="dropdown-item d-flex align-items-center" href="#">
                                    <div class="dropdown-list-image mr-3">
                                        <img class="rounded-circle" src="img/undraw_profile_1.svg"
                                             alt="...">
                                        <div class="status-indicator bg-success"></div>
                                    </div>
                                    <div class="font-weight-bold">
                                        <div class="text-truncate">
                                            Hi there! I am wondering if you can help me with a
                                            problem I've been having.
                                        </div>
                                        <div class="small text-gray-500">Emily Fowler · 58m</div>
                                    </div>
                                </a>
                                <a class="dropdown-item d-flex align-items-center" href="#">
                                    <div class="dropdown-list-image mr-3">
                                        <img class="rounded-circle" src="img/undraw_profile_2.svg"
                                             alt="...">
                                        <div class="status-indicator"></div>
                                    </div>
                                    <div>
                                        <div class="text-truncate">
                                            I have the photos that you ordered last month, how
                                            would you like them sent to you?
                                        </div>
                                        <div class="small text-gray-500">Jae Chun · 1d</div>
                                    </div>
                                </a>
                                <a class="dropdown-item d-flex align-items-center" href="#">
                                    <div class="dropdown-list-image mr-3">
                                        <img class="rounded-circle" src="img/undraw_profile_3.svg"
                                             alt="...">
                                        <div class="status-indicator bg-warning"></div>
                                    </div>
                                    <div>
                                        <div class="text-truncate">
                                            Last month's report looks great, I am very happy with
                                            the progress so far, keep up the good work!
                                        </div>
                                        <div class="small text-gray-500">Morgan Alvarez · 2d</div>
                                    </div>
                                </a>
                                <a class="dropdown-item d-flex align-items-center" href="#">
                                    <div class="dropdown-list-image mr-3">
                                        <img class="rounded-circle" src="https://source.unsplash.com/Mv9hjnEUHR4/60x60"
                                             alt="...">
                                        <div class="status-indicator bg-success"></div>
                                    </div>
                                    <div>
                                        <div class="text-truncate">
                                            Am I a good boy? The reason I ask is because someone
                                            told me that people say this to all dogs, even if they aren't good...
                                        </div>
                                        <div class="small text-gray-500">Chicken the Dog · 2w</div>
                                    </div>
                                </a>
                                <a class="dropdown-item text-center small text-gray-500" href="#">Read More Messages</a>
                            </div>
                        </li>

                        <div class="topbar-divider d-none d-sm-block"></div>

                        <!-- Nav Item - User Information -->
                        <li class="nav-item dropdown no-arrow">
                            <a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button"
                               data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                                <span class="mr-2 d-none d-lg-inline text-gray-600 initial">Espace Administrateur Sytème</span>
                                <img class="img-profile rounded-circle"
                                     src="~/img/undraw_profile.svg">
                            </a>
                            <!-- Dropdown - User Information -->
                            <div class="dropdown-menu dropdown-menu-right shadow animated--grow-in"
                                 aria-labelledby="userDropdown">
                                <a class="dropdown-item" href="#">
                                    <i class="fas fa-user fa-sm fa-fw mr-2 text-gray-400"></i>
                                    Profile
                                </a>
                                <a class="dropdown-item" href="#">
                                    <i class="fas fa-cogs fa-sm fa-fw mr-2 text-gray-400"></i>
                                    Settings
                                </a>
                                <a class="dropdown-item" href="#">
                                    <i class="fas fa-list fa-sm fa-fw mr-2 text-gray-400"></i>
                                    Activity Log
                                </a>
                                <div class="dropdown-divider"></div>
                                <a class="dropdown-item" href="#" data-toggle="modal" data-target="#logoutModal">
                                    <i class="fas fa-sign-out-alt fa-sm fa-fw mr-2 text-gray-400"></i>
                                    Logout
                                </a>
                            </div>
                        </li>

                        <li>
                            <div>
                                <a href="~/Account/Login" class="btn-log-out" style="border: 2px solid #004289; color: #004289; margin-left: 100px;
border-radius: 50px; text-align: center; padding: 5px 20px 5px 20px; " onmouseover="this.style.background = '#004289';
this.style.color = '#ffffff';" onmouseout="this.style.background='#ffffff'; this.style.color='#1549c2';">Déconnexion</a>
                            </div>
                        </li>
                    </ul>

                </nav>
            </div>
            <!-- Area Chart -->
            <div class="col-xl-8 col-lg-7">
                <div class="card shadow mb-4" style=" width:1200px;">
                    <!-- Card Header - Dropdown -->
                    <div class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                        <h6 class="m-0 font-weight-bold text-primary">Les Utilsateurs</h6>
                        <div class="dropdown no-arrow">
                            <a class="dropdown-toggle" href="#" role="button" id="dropdownMenuLink"
                               data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <i class="fas fa-ellipsis-v fa-sm fa-fw text-gray-400"></i>
                            </a>
                            <div class="dropdown-menu dropdown-menu-right shadow animated--fade-in"
                                 aria-labelledby="dropdownMenuLink">
                                <div class="dropdown-header">Dropdown Header:</div>
                                <a class="dropdown-item" href="#">Action</a>
                                <a class="dropdown-item" href="#">Another action</a>
                                <div class="dropdown-divider"></div>
                                <a class="dropdown-item" href="#">Something else here</a>
                            </div>
                        </div>
                    </div>
                    <!-- Card Body -->
                    <div class="card-body" style="height:800px; width:1200px;">
                        <div class="chart-area">
                            <div class="container" style="margin-top: 3%">
                                <h4 style="text-align: center; font-family: initial; color: #3a78d3; margin-top: 2%;">Les Utilisateurs de l'application <i class="bi bi-people-fill" style="color: #3a78d3;"></i></h4>

                                <div class="row mt-3">
                                    <div class="col-md-12">
                                        <a href="#" class="btn primary-btn" onclick="AddUser(0)" style="background-color:#e9ecef; -bs-btn-color: #000; --bs-btn-bg: #dee2e6; --bs-btn-border-color: rgba(13, 110, 253, .25); --bs-btn-hover-color: #000; --bs-btn-hover-bg: #dee2e6; --bs-btn-hover-border-color: #2b2b2b; --bs-btn-focus-shadow-rgb: #fff; --bs-btn-active-bg: #e9ecef; --bs-btn-active-border-color: #e9ecef; ">
                                            Ajouter Utilisateur
                                        </a>
                                    </div>
                                </div>
                                <div class="row mt-3" style="max-height: 300px; overflow-y: auto;">
                                    <div class="col-md-12">
                                        <table id="bsTable" class="table table-hover" style="text-align: center; border-color: #2b2b2b;">
                                            <thead style="border-color: #000000;">
                                                <tr>

                                                    <th>Nom</th>
                                                    <th>Prenom</th>
                                                    <th>UserName</th>
                                                    <th>Mot de Passe</th>
                                                    <th>Role</th>
                                                    <th colspan="3">Action</th>
                                                </tr>
                                            </thead>
                                            <tbody id="bodyTable">
                                                <tr id="loadingStatus" style="color: red"></tr>
                                            </tbody>

                                        </table>
                                    </div>
                                </div>

                            </div>
                            <div style="display:flex; justify-content:space-between; margin-left:5%;">
                                <div style="display:flex; justify-content:space-between;">
                                    <label for="pageSizeSelect" style="margin-top:20px">Nombre d'éléments par page:</label>
                                    <select id="pageSizeSelect" class="form-control" style="height: 35px; margin-top: 15px; margin-left: 15px;">
                                        <option value="5">5</option>
                                        <option value="10">10</option>
                                        <option value="50">50</option>
                                        <option value="100">100</option>


                                        <!-- Ajoutez d'autres options de taille de page si nécessaire -->
                                    </select>
                                </div>
                                <nav aria-label="Page navigation example" class="d-flex justify-content-end" style="margin-top: 20px; margin-right:80px; margin-bottom:20%;">
                                    <ul class="pagination">
                                        <li class="page-item" id="previousPage">
                                            <a class="page-link" href="javascript:;" aria-label="Previous">
                                                <span aria-hidden="true">&laquo; Précédent</span>
                                            </a>
                                        </li>
                                        <li class="page-item" id="nextPage">
                                            <a class="page-link" href="javascript:;" aria-label="Next">
                                                <span aria-hidden="true">Suivant &raquo;</span>
                                            </a>
                                        </li>
                                    </ul>
                                </nav>
                            </div>


                            <canvas id="myAreaChart">
                            </canvas>
                        </div>
                    </div>
                </div>
            </div>
            <!--                                                                        table                                             -->
            <script>
                $(document).ready(function () {
                    $('#bsTable').DataTable({
                        "paging": true, // Activer la pagination
                        "pageLength": 5 // Nombre d'éléments par page
                    });
                });
            </script>


            <div class="modal fade" id="MyModal">
                <div class="modal-dialog modal-dialog-scrollable" id="Modal">
                    <div class="modal-content">
                        <!-- Header -->
                        <div class="modal-header">
                            <h4 id="ModalTitle"></h4>
                            <a href="taux" class="close" data-dismiss="modal" style="margin-top: -30;">&times;</a>
                        </div>

                        <!-- Body -->
                        <div class="modal-body">
                            <form id="form">
                                <fieldset id="SubmitForm">
                                    <div class="form-group">
                                        @Html.HiddenFor(m => m.id, new { @id = "id" })
                                    </div>

                                    <div class="form-group">
                                        <label for="nom" class="required">Nom:</label>
                                        @Html.TextBoxFor(m => m.nom, new { @id = "nom", @class = "form-control" })
                                    </div>
                                    <div class="form-group">
                                        <label for="pre" class="required">Prenom:</label>
                                        @Html.TextBoxFor(m => m.prenom, new { @id = "pre", @class = "form-control" })
                                    </div>
                                    <div class="form-group">
                                        <label for="un" class="required">Nom d'Utilisateur:</label>
                                        @Html.TextBoxFor(m => m.Name, new { @id = "un", @class = "form-control" })
                                    </div>
                                    <div class="form-group">
                                        <label for="pwd" class="required">Mot De Passe:</label>
                                        <div class="input-group">
                                            @Html.PasswordFor(m => m.password, new { @id = "pwd", @class = "form-control" })
                                            <div class="input-group-append">
                                                <button id="togglePassword" type="button" class="btn btn-outline-secondary">
                                                    <i class="fa fa-eye" id="toggleIcon"></i>
                                                </button>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label for="role" class="required">Role:</label>

                                        @Html.DropDownListFor(m => m.role, new SelectList(new[] { "Admin Système", "Admin", "Adhérent" }), new { @id = "role", @class = "form-control" })
                                    </div>
                                </fieldset>
                                <div class="modal-footer">
                                    <div class="form-group">
                                        <a href="User" class="btn btn-danger" data-dismiss="modal">Fermer</a>
                                        <a href="#" class="btn btn-success" id="SaveUserRecord">Enregistrer</a>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>

            <div class="modal fade" id="DeleteConfirmation">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h4 style="font-weight: bold; color: #000; margin: 0 auto;"><i class="bi bi-circle-fill" style="color:red;"></i> Supprimer utilisateur</h4>
                            <a href="User" class="close" data-dismiss="modal" style="margin-top: -30;">&times;</a>
                        </div>
                        <div class="modal-body">
                            <h5> Etes-vous sûr de vouloir supprimer cet utilisateur ?</h5>
                        </div>
                        <div class="modal-footer">
                            <a href="User" class="btn btn-primary" data-dismiss="modal">Annuler</a>
                            <a href="#" class="btn btn-danger" onclick="ConfirmDelete()">Confirmer</a>
                        </div>
                    </div>
                </div>
            </div>



            <!-- End of Main Content -->
            <!-- Footer -->
            <footer class="sticky-footer bg-white">
                <div class="container my-auto">
                    <div class="copyright text-center my-auto">
                        <span>Copyright &copy; Tunisair Website 2024</span>
                    </div>
                </div>
            </footer>
            <!-- End of Footer -->

        </div>
        <!-- End of Content Wrapper -->





    </div>
    <!-- End of Page Wrapper -->
    <!-- Scroll to Top Button-->
    <a class="scroll-to-top rounded" href="#page-top">
        <i class="fas fa-angle-up"></i>
    </a>

    <!-- Logout Modal-->
    <div class="modal fade" id="logoutModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
         aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Ready to Leave?</h5>
                    <button class="close" type="button" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">×</span>
                    </button>
                </div>
                <div class="modal-body">Select "Logout" below if you are ready to end your current session.</div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" type="button" data-dismiss="modal">Cancel</button>
                    <a class="btn btn-primary" href="login.html">Logout</a>
                </div>
            </div>
        </div>
    </div>

    <script src="~/vendor/jquery/jquery.min.js"></script>
    <!-- Bootstrap core JavaScript-->
    <script src="~/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

    <!-- Core plugin JavaScript-->
    <script src="~/vendor/jquery-easing/jquery.easing.min.js"></script>

    <!-- Custom scripts for all pages-->
    <script src="~/js/sb-admin-2.min.js"></script>

    <!-- Page level plugins -->
    <script src="~/vendor/chart.js/Chart.min.js"></script>

    <!-- Page level custom scripts -->
    <script src="~/js/demo/chart-area-demo.js"></script>
    <script src="~/js/demo/chart-pie-demo.js"></script>

</body>

<script>

    $("#loadingStatus").html("Loading ...");

    $.get("/User/GetUserList", null, function (userList) {
        // Fonction appelée lorsque les données JSON sont reçues avec succès
        DataBind(userList);
    });



    function DataBind(userList) {
        var SetData = $("#bodyTable");
        for (var i = 0; i < userList.length; i++) {

            var Data = "<tr class='row_" + userList[i].id + "'>" +
                "<td>" + userList[i].nom + "</td>" +
                "<td>" + userList[i].prenom + "</td>" +
                "<td>" + userList[i].Name + "</td>" +
                "<td>" + userList[i].password + "</td>" +

                "<td>" + userList[i].role + "</td>" +
                "<td><a href='#' class='btn btn-warning' onclick='EditUser(" + userList[i].id + ")'><i class='fas fa-edit small-icon text-white'></i></a></td>" +
                "<td><a href='#' class='btn btn-danger' onclick='DeleteUserRecord(" + userList[i].id + ")'><i class='fas fa-trash-alt small-icon text-white'></i></a></td>" +
                "<td><a href='#' class='btn btn-info' onclick='ShowUserDetails(" + userList[i].id + ")'><i class='fas fa-info-circle small-icon text-white'></i></a></td>" +
                "</tr>";
            SetData.append(Data);
        }

        $("#loadingStatus").html(" ");
    }



    //---------------------------------------------Pagination


    // pagination element par page
    (function () {
        // Gestionnaire d'événements pour le sélecteur de taille de page
        $('#pageSizeSelect').change(function () {
            // Récupérer la nouvelle valeur sélectionnée
            var newPageSize = $(this).val();

            // Appeler la fonction pour récupérer et afficher les données avec la nouvelle taille de page
            fetchDataWithPageSize(1, newPageSize); // Commencer à partir de la première page après le changement de taille
        });

        // Fonction pour récupérer et afficher les données avec une nouvelle taille de page
        function fetchDataWithPageSize(page, pageSize) {
            $.get("/User/GetUserList", { page: page, pageSize: pageSize }, function (userList) {
                // Appeler la fonction de liaison des données avec la nouvelle liste de bulletins de soin
                $("#bodyTable").empty();
                DataBind(userList);
            });
        }

        // Fonction pour récupérer et afficher les données
        function loadData(page, pageSize) {
            $.ajax({
                url: '/User/GetUserList',
                type: 'GET',
                data: { page: page, pageSize: pageSize },
                dataType: 'json',
                success: function (data) {
                    // Mettre à jour votre tableau HTML avec les données récupérées
                    // Ici, 'data' contient les données renvoyées par votre méthode backend
                    // Vous pouvez itérer sur 'data' pour construire les lignes de votre tableau
                    // et les ajouter à votre tableau existant
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    console.log('Error:', textStatus, errorThrown);
                }
            });
        }
    })();

    // code pour page suivante et precedente
    $(document).ready(function () {
        var currentPage = 1;
        var pageSize = 5; // Taille de la page par défaut
        var totalPages = 10; // Nombre total de pages

        // Fonction pour charger les données de la page spécifiée et mettre à jour l'interface utilisateur
        function loadData2(page, pageSize) {
            $.get("/User/GetUserList2", { page: page, pageSize: pageSize }, function (response) {
                $('#bodyTable').empty(); // Videz d'abord le contenu existant du tableau
                var data = response.data; // Assurez-vous que votre backend renvoie les données dans un objet 'data'
                $.each(data, function (index, item) {

                    var row = '<tr>' +
                        "<td>" + item.nom + "</td>" +
                        "<td>" + item.prenom + "</td>" +
                        "<td>" + item.Name + "</td>" +
                        "<td>" + item.password + "</td>" +
                        "<td>" + item.role + "</td>" +
                        "<td><a href='#' class='btn btn-warning' onclick='EditUser(" + item.id + ")'><i class='fas fa-edit small-icon text-white'></i></a></td>" +
                        "<td><a href='#' class='btn btn-danger' onclick='DeleteUserRecord(" + item.id + ")'><i class='fas fa-trash-alt small-icon text-white'></i></a></td>" +
                        "<td><a href='#' class='btn btn-info' onclick='ShowUserDetails(" + item.id + ")'><i class='fas fa-info-circle small-icon text-white'></i></a></td>" +
                        "</tr>";
                    $('#bodyTable').append(row);
                });
                // Mettre à jour le nombre total de pages après avoir obtenu les données
                totalPages = Math.ceil(response.totalRecords / pageSize);
                // Mettre à jour l'état des boutons de pagination
                updatePaginationButtons();
            });
        }

        // Fonction pour mettre à jour l'état des boutons de pagination
        function updatePaginationButtons() {
            $('#previousPage').prop('disabled', currentPage <= 1);
            $('#nextPage').prop('disabled', currentPage >= totalPages);
        }

        // Gestionnaire d'événements pour le bouton Précédent
        $('#previousPage').click(function () {
            if (currentPage > 1) {
                currentPage--;
                loadData2(currentPage, pageSize);
            }
        });

        // Gestionnaire d'événements pour le bouton Suivant
        $('#nextPage').click(function () {
            if (currentPage < totalPages) {
                currentPage++;
                loadData2(currentPage, pageSize);
            }
        });

        // Gestionnaire d'événements pour le sélecteur de taille de page
        $('#pageSizeSelect').change(function () {
            pageSize = $(this).val();
            loadData(1, pageSize); // Appel de la fonction loadData ici
        });

        // Appel initial pour charger les données de la première page
        loadData(currentPage, pageSize);
    });

    function reloadData() {
        loadData2(currentPage, pageSize);
    }



    function AddUser(id) {
        $("#form")[0].reset();
        $("#ModalTitle").html("Ajouter Nouveau Utilisateur  ");
        $("#MyModal").modal("show");

        $("#id").val("");
        $("#nom").val("");
        $("#pre").val("");
        $("#un").val("");
        $("#pwd").val("");
        $("#role").val("");
    }


    function EditUser(id) {
        var url = "/User/GetUserById?id=" + id;

        $("#ModalTitle").html("Modifier Utilisateur");
        $("#MyModal").modal("show");
        $.ajax({
            type: "GET",
            url: url,
            success: function (data) {
                var obj = JSON.parse(data);
                $("#id").val(obj.id);

                $("#nom").val(obj.nom);
                $("#pre").val(obj.prenom);
                $("#un").val(obj.username);
                $("#pwd").val(obj.paassword);
                $("#role").val(obj.role);
            }
        });
    }

    $("#SaveUserRecord").click(function () {
        var data = $("#SubmitForm").serialize();
        $.ajax({
            type: "POST",
            url: "/User/SaveDataInDatabase",
            data: data,
            success: function (response) {
                if (response.success) {
                    alert("Success!");
                    window.location.href = "/User/tables";
                    $("#MyModal").modal("hide");
                    reloadData();  // Rafraîchir les données après ajout

                } else {
                    alert("Erreur lors de l'enregistrement des données: " + response.errors);
                }
            },
            error: function (xhr, status, error) {
                alert("Une erreur s'est produite lors de l'envoi des données au serveur. Statut: " + status + ", Erreur: " + error);
            }
        });
    });
    function ShowUserDetails(id) {
        var url = "/User/GetUserById?id=" + id;
        $("#SaveUserRecord").hide();
        
        $("#ModalTitle").html("Détailles Utilsateur");
        $("#MyModal").modal("show");
        $.ajax({
            type: "GET",
            url: url,
            success: function (data) {
                var obj = JSON.parse(data);
                $("#id").val(obj.id).prop('disabled', true);

                $("#nom").val(obj.nom).prop('disabled', true);
                $("#pre").val(obj.prenom).prop('disabled', true);
                $("#un").val(obj.username).prop('disabled', true);
                $("#pwd").val(obj.paassword).prop('disabled', true);
                $("#role").val(obj.role).prop('disabled', true);
            }
        });

    }
    function DeleteUserRecord(id) {
        $("#id").val(id);
        $("#DeleteConfirmation").modal("show");
    }

    function ConfirmDelete() {
        var id = $("#id").val();
        $.ajax({
            type: "POST",
            url: "/User/DeleteUserRecord?id=" + id,
            success: function (result) {
                $("#DeleteConfirmation").modal("hide");
                alert("utilisateur supprimé!");
                window.location.href = "/User/tables";
                reloadData();  // Rafraîchir les données après modification

                if (result) {
                    $(".row_" + id).remove();
                    reloadData();  // Rafraîchir les données après suppression

                } else {
                    alert("Failed to delete taux record.");
                }
            },
            error: function () {
                alert("An error occurred while deleting the taux record.");
            }
        });
    }





</script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        $(document).ready(function () {
            $('#togglePassword').on('click', function () {
                var passwordField = $('#pwd');
                var passwordFieldType = passwordField.attr('type');
                var toggleIcon = $('#toggleIcon');

                if (passwordFieldType === 'password') {
                    passwordField.attr('type', 'text');
                    toggleIcon.removeClass('fa-eye').addClass('fa-eye-slash');
                } else {
                    passwordField.attr('type', 'password');
                    toggleIcon.removeClass('fa-eye-slash').addClass('fa-eye');
                }
            });
        });
    </script>
